{% extends 'base.html' %}
{% block css_url %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pred/table_result.css') }}">
{% endblock css_url %}

{% block content %}
<div class="p-8">
    
    <h1 class="my-8 text-3xl font-bold">Staging Area untuk input Data Manual</h1>

    <div class="scrol-table scroll-smooth focus:scroll-auto">
        <table class="dataframe table-auto" id="prediction_results">
            <thead>
                <tr id="tr-thead">
                    
                </tr>
            </thead>
            <tbody id="tbody">
                
            </tbody>
        </table>
    </div>

    <div class="flex justify-end me-14 mb-5">
        <button type="submit" class="px-5 py-2 rounded bg-primary-color font-semibold text-slate-100">Run</button>
    </div>

    <!-- Menyimpan URL dalam atribut data -->
    <!-- <div id="updLinkData" data-url="{{ url_for('land_predict.update_manual_data', dataset=data_test_json) }}" style="display: none;"></div> -->
    <div id="updLinkData" data-url="{{ url_for('land_predict.update_manual_data') }}" style="display: none;"></div>
    <div id="dltLinkData" data-url="{{ url_for('land_predict.delete_manual_data') }}" style="display: none;"></div>

    <form action="{{ url_for('land_predict.result_manual_data', dataset=data_test) }}" method="post">
        <input type="submit">
    </form>



    
</div>

<script>
    var data_test = JSON.parse('{{ data_test | safe }}');
    // console.log(typeof data_test); // object

    for (property in data_test) {
        // console.log(`${property}: ${data_test[property]}`);
    }

    const tbody = document.getElementById('tbody');
    const thead = document.getElementById('tr-thead');
    // ini untuk head
    for (property in data_test[0]) {
        // jika th sama dengan 'id_m' maka tidak di tampilkan
        if (property != 'id_m') {
            var th = document.createElement('th');
            th.innerText = `${property}`;
            thead.appendChild(th);
        }
    }

    // ini untuk body
    for (property in data_test) {
        // membuatnya dari tr
        var trbody = document.createElement('tr');
        // console.log(data_test[property]['id_m']);
        for (nilai in data_test[property]){
            // console.log(nilai);
            // jika nilai sama dengan 'id_m' maka tidak di tampilkan
            // if (nilai != 'id_m') {
            //     var td = document.createElement('td');
            //     td.innerText = `${data_test[property][nilai]}`;
            //     trbody.appendChild(td);
            // } else {
            //     var id_m = data_test[property][nilai];
            //     // trbody.setAttribute('id', id_m);
            // }

            if (nilai == 'id_m') {
                var id_m = data_test[property][nilai];
            } else {
                var td = document.createElement('td');
                td.innerText = `${data_test[property][nilai]}`;
                trbody.appendChild(td);
            }
            
            // console.log(data_test[property][nilai]);
        }

        // ini untuk icon trash dan update
        // update button
        var url = updLinkData.getAttribute('data-url');
        var urlDlt = dltLinkData.getAttribute('data-url');

        var actionTd = document.createElement('td');
        var updLink = document.createElement('a')
        updLink.setAttribute('href', url + '?id_m=' + id_m);
        var buttonUpd = document.createElement('button');
        var updIcon = document.createElement('i');
        updIcon.classList.add('fa-regular', 'fa-pen-to-square');
        buttonUpd.appendChild(updLink);
        updLink.appendChild(updIcon);
        actionTd.appendChild(buttonUpd);
        // delete button
        var dltLink = document.createElement('a');
        dltLink.setAttribute('href', urlDlt + '?id_m=' + id_m);
        var buttonDlt = document.createElement('button');
        var dltIcon = document.createElement('i');
        dltIcon.classList.add('fa-solid', 'fa-trash');
        buttonDlt.appendChild(dltLink);
        dltLink.appendChild(dltIcon);
        actionTd.appendChild(buttonDlt);
        trbody.appendChild(actionTd);
        
        

        // delete button
        tbody.appendChild(trbody);
    }
    // action th button icon td
    const actionTh = document.createElement('th');
    actionTh.innerText = "Action";
    thead.appendChild(actionTh);
</script>

{% endblock content %}