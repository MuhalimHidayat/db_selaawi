{% extends 'base.html' %}
{% block css_url %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/pallete.css') }}">
{% endblock css_url %}

{% block content %}
<div class="flex justify-center w-full">
    <div class="w-4/5">
        <div id="content-header" class="w-full bg-header-predictions-color rounded-md p-6 mb-8">
            <h1 class="text-2xl font-semibold font-predictions-color-header">Staging Area Input Data</h1>
            <p class="text-slate-50 mt-3 text-sm">Lorem ipsum dolor sit amet consectetur adipisicing elit. Ea, nesciunt.
            </p>
        </div>
        <div class="flex justify-start mx-5 my-2">
            <a href="{{ url_for('land_predict.add_manual_data') }}"
                class="flex text-white text-sm font-semibold justify-between items-center gap-x-2 ps-4 pe-5 py-1 bg-button-user-color rounded">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                    <path
                        d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z" />
                </svg>
                <span>ADD</span>
            </a>

            <!-- alghrotim choosing - dropdown button -->
            <!-- <form action="" method="post">
                <select name="alghrotim">
                    <option value="knn">K-Nearest Neighbors</option>
                    <option value="dt">Decision Tree</option>
                    <option value="rf">Random Forest</option>
                </select>
                <button>submit</button>
            </form> -->
            
        </div>

        <div class="overflow-x-auto shadow-md sm:rounded-lg px-5 py-3">
            <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                <thead
                    class="text-xs text-center text-white uppercase bg-primary-color  dark:bg-gray-700 dark:text-gray-400">
                    <tr id="tr-thead">

                    </tr>
                </thead>
                <tbody class="text-center" id="tbody">

                </tbody>
            </table>


        </div>

        <!-- Menyimpan URL dalam atribut data -->
        <!-- <div id="updLinkData" data-url="{{ url_for('land_predict.update_manual_data', dataset=data_test_json) }}" style="display: none;"></div> -->
        <div id="updLinkData" data-url="{{ url_for('land_predict.update_manual_data') }}" style="display: none;"></div>
        <div id="dltLinkData" data-url="{{ url_for('land_predict.delete_manual_data') }}" style="display: none;"></div>
        <div class="flex justify-end me-14 my-5">
            <button type="submit" class="px-8 py-3 rounded bg-button-user-color font-medium text-slate-100"><a href="{{ url_for('land_predict.result_manual_data', dataset=data_test) }}">Convert</a></button>
        </div>
        <!-- {{ url_for('land_predict.result_manual_data', dataset=data_test) }} -->
    </div>




</div>

<script>
    var data_test = JSON.parse('{{ data_test | safe }}');
    // console.log(typeof data_test); // object

    for (property in data_test) {
        // console.log(`${property}: ${data_test[property]}`);
    }

    const tbody = document.getElementById('tbody');
    const thead = document.getElementById('tr-thead');
    // ini untuk head
    for (property in data_test[0]) {
        // jika th sama dengan 'id_m' maka tidak di tampilkan
        if (property != 'id_m') {
            var th = document.createElement('th');
            th.setAttribute('scope', 'col')
            th.setAttribute('class', 'px-6 py-3')
            th.innerText = `${property}`;
            thead.appendChild(th);
        }
    }

    // ini untuk body
    for (property in data_test) {
        // membuatnya dari tr
        var trbody = document.createElement('tr');
        trbody.setAttribute('class', 'bg-white border-b dark:bg-gray-800');
        // console.log(data_test[property]['id_m']);
        for (nilai in data_test[property]) {
            // console.log(nilai);
            // jika nilai sama dengan 'id_m' maka tidak di tampilkan
            // if (nilai != 'id_m') {
            //     var td = document.createElement('td');
            //     td.innerText = `${data_test[property][nilai]}`;
            //     trbody.appendChild(td);
            // } else {
            //     var id_m = data_test[property][nilai];
            //     // trbody.setAttribute('id', id_m);
            // }

            if (nilai == 'id_m') {
                var id_m = data_test[property][nilai];
            } else {
                var td = document.createElement('td');
                td.setAttribute('class', 'px-6 py-4 whitespace-nowrap ')
                td.innerText = `${data_test[property][nilai]}`;
                trbody.appendChild(td);
            }

            // console.log(data_test[property][nilai]);
        }

        // ini untuk icon trash dan update
        // update button
        var url = updLinkData.getAttribute('data-url');
        var urlDlt = dltLinkData.getAttribute('data-url');

        var actionTd = document.createElement('td');
        var updLink = document.createElement('a')
        updLink.setAttribute('href', url + '?id_m=' + id_m);
        var buttonUpd = document.createElement('button');
        var updIcon = document.createElement('i');
        updIcon.classList.add('fa-regular', 'fa-pen-to-square');
        buttonUpd.appendChild(updLink);
        updLink.appendChild(updIcon);
        actionTd.appendChild(buttonUpd);
        // delete button
        var dltLink = document.createElement('a');
        dltLink.setAttribute('href', urlDlt + '?id_m=' + id_m);
        var buttonDlt = document.createElement('button');
        var dltIcon = document.createElement('i');
        dltIcon.classList.add('fa-solid', 'fa-trash');
        buttonDlt.appendChild(dltLink);
        dltLink.appendChild(dltIcon);
        actionTd.appendChild(buttonDlt);
        trbody.appendChild(actionTd);



        // delete button
        tbody.appendChild(trbody);
    }
    // action th button icon td
    const actionTh = document.createElement('th');
    actionTh.setAttribute('scope', 'col');
    actionTh.setAttribute('class', 'px-6 py-3');
    actionTh.innerText = "Action";
    thead.appendChild(actionTh);
</script>

{% endblock content %}